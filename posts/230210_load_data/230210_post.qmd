---
title: "Load the data"
author: "Nick van Doormaal"
date: "2023-02-10"
categories: [load, read, data.table, fread, csv, sf, spatial]
description: "In this post, I will show how to get your data in R; the first step of building the interactive report"
execute: 
  message: false
  warning: false
editor_options:
  chunk_output_type: console
---

# Get your data in R

Before we can do anything, we first need to somehow get our data in R. In this blog post, I'll go into detail on several ways to do that. I

## Reading a single csv-file

Perhaps the most common type of files used in data analyses are csv-files. You can read in your data using one of the ways below.

### read_csv

The function `read_csv` comes from the `readr`-package (which is part of the Tidyverse). The `read_csv` function takes several arguments for more advanced manipulations, but let's keep things simple for now.

```{r load-data-csv}
library(readr) ## this package is needed to get access to the read_csv function

patrol_data <- data.table::fread(
  file = "./posts/230210_load_data/data/Andy_Verzmoter_tracking_2022-04-20_10_39.csv.csv"
)
```

### R code

This is \`inline\` code plus a small code chunk.

```{r}
library(tidyverse)

ggplot(mpg) +
  geom_jitter(
    aes(cty, hwy), size = 4, alpha = 0.5
  )
```

### 3 - Tabsets

```{r}
knitr::opts_chunk$set(collapse = T)

library(tidyverse)

dat <- palmerpenguins::penguins %>% 
  filter(!is.na(sex))
lm.mod <- dat %>%
  mutate(
    sex = if_else(sex == 'male', 1, 0),
  ) %>% 
  lm(data = ., sex ~ body_mass_g + bill_length_mm + species) 
preds_lm <- dat %>% 
  mutate(
    prob.fit = plogis(lm.mod$fitted.values),
    prediction = if_else(prob.fit > 0.5, 'male', 'female'),
    correct = if_else(sex == prediction, 'correct', 'incorrect')
  )
```

::: panel-tabset
### Transforming new

```{r}
#| code-fold: true

preds_lm %>% 
  ggplot(aes(body_mass_g, bill_length_mm, col = correct)) +
  geom_jitter(size = 4, alpha = 0.6) +
  facet_wrap(vars(species)) +
  scale_color_manual(values = c('grey60', thematic::okabe_ito(3)[3])) +
  scale_x_continuous(breaks = seq(3000, 6000, 1000)) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = 'top', 
    panel.background = element_rect(color = 'black'),
    panel.grid.minor = element_blank()
  ) +
  labs(
    x = 'Body mass (in g)',
    y = 'Bill length (in mm)'
  )
```
:::
